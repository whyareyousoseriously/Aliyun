核查规则编码	核查规则名称	核查规则内容描述	核查规则类型编码	核查规则类型名称	状态	负责人	负责人邮箱	负责人手机	数据表	监控脚本
check_001	订单表订单时间格式出错	订单表内订单时间格式出错	1	错误值	1	小王	xiaowang@aliyun.com	13900000001	ODS_EBUSI_ORDERS	SELECT ORDER_ID,ORDER_TIME FROM ODS_EBUSI_ORDERS WHERE NOT(INSTR(ORDER_TIME,'-',1,1) = 5 AND INSTR(ORDER_TIME,'-',1,2) = 8 AND INSTR(ORDER_TIME,'-',1,3) = 0) or NOT(INSTR(ORDER_TIME,':',1,1) = 14 AND INSTR(ORDER_TIME,':',1,2) = 17 AND INSTR(ORDER_TIME,'-',1,3) = 0)
check_002	订单表同一客户同一时间多次订单	订单表同一客户同一时间下了多次订单	2	重复值	1	小王	xiaowang@aliyun.com	13900000001	ODS_EBUSI_ORDERS	SELECT CUSTOMER_ID, ORDER_TIME, COUNT(DISTINCT ORDER_ID) ORDER_CNT FROM ODS_EBUSI_ORDERS GROUP BY CUSTOMER_ID, ORDER_TIME HAVING COUNT(DISTINCT ORDER_ID) > 1
check_003	客户信息表省份信息异常	客户信息表省份信息异常	3	数据不一致	1	小张	xiaozhang@aliyun.com	13900000002	ODS_EBUSI_CUSTOMERS\ODS_EBUSI_DIM_PROVINCE	SELECT A.CUSTOMER_ID,A.PROVINCE_ID,A.PROVINCE_NAME,B.PROVINCE_ID,B.PROVINCE_NAME FROM ODS_EBUSI_CUSTOMERS A INNER JOIN ODS_EBUSI_DIM_PROVINCE B ON A.PROVINCE_ID = B.PROVINCE_ID WHERE A.PROVINCE_NAME <> B.PROVINCE_NAME
check_004	配送表订单信息异常	配送的订单在订单表中不存在	4	数据完整性	1	小强	xiaoqiang@aliyun.com	13900000003	ODS_EBUSI_DISPATCH\ODS_EBUSI_ORDERS	SELECT A.ORDER_ID FROM ODS_EBUSI_DISPATCH A LEFT OUTER JOIN ODS_EBUSI_ORDERS B ON A.ORDER_ID=B.ORDER_ID WHERE B.ORDER_ID IS NULL
check_005	客户信息表性别信息缺失	客户信息表性别信息缺失	5	缺失值	1	小张	xiaozhang@aliyun.com	13900000002	ODS_EBUSI_CUSTOMERS	SELECT * FROM ODS_EBUSI_CUSTOMERS A WHERE A.GENDER IS NULL
check_006	同客户单月下订单次数异常	同客户单月购买次数异常（当月购买次数大于10次）	6	异常值	1	小强	xiaoqiang@aliyun.com	13900000003	ODS_EBUSI_ORDERS	SELECT SUBSTR(ORDER_TIME,1,10),CUSTOMER_ID,COUNT(1) FROM ODS_EBUSI_ORDERS A GROUP BY SUBSTR(ORDER_TIME,1,10),CUSTOMER_ID HAVING COUNT(1) > 10
